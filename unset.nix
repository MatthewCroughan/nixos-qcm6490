{ lib, ... }:
{
  boot.kernelPatches = [
    {
      name = "config-disable-unused-modules";
      patch = null;
      extraStructuredConfig = {
        ROCKCHIP_DW_HDMI_QP = lib.mkForce lib.kernel.unset;
        DRM_AMD_ISP = lib.mkForce lib.kernel.unset;
        "8139TOO_8129" = lib.mkForce lib.kernel.unset;
        "8139TOO_PIO" = lib.mkForce lib.kernel.unset;
        ACPI_APEI = lib.mkForce lib.kernel.unset;
        ACPI_APEI_GHES = lib.mkForce lib.kernel.unset;
        ACPI_FPDT = lib.mkForce lib.kernel.unset;
        ACPI_HMAT = lib.mkForce lib.kernel.unset;
        ACPI_HOTPLUG_CPU = lib.mkForce lib.kernel.unset;
        ACPI_HOTPLUG_MEMORY = lib.mkForce lib.kernel.unset;
        AIC79XX_DEBUG_ENABLE = lib.mkForce lib.kernel.unset;
        AIC7XXX_DEBUG_ENABLE = lib.mkForce lib.kernel.unset;
        AIC94XX_DEBUG = lib.mkForce lib.kernel.unset;
        ATH9K_PCI = lib.mkForce lib.kernel.unset;
        BCMA_HOST_PCI = lib.mkForce lib.kernel.unset;
        BPF_LSM = lib.mkForce lib.kernel.unset;
        BRCMFMAC_PCIE = lib.mkForce lib.kernel.unset;
        CHROMEOS_TBMC = lib.mkForce lib.kernel.unset;
        DEFAULT_SECURITY_APPARMOR = lib.mkForce lib.kernel.unset;
        DRM_AMDGPU_CIK = lib.mkForce lib.kernel.unset;
        DRM_AMDGPU_SI = lib.mkForce lib.kernel.unset;
        DRM_AMDGPU_USERPTR = lib.mkForce lib.kernel.unset;
        DRM_AMD_ACP = lib.mkForce lib.kernel.unset;
        DRM_AMD_DC_FP = lib.mkForce lib.kernel.unset;
        DRM_AMD_DC_SI = lib.mkForce lib.kernel.unset;
        DRM_AMD_SECURE_DISPLAY = lib.mkForce lib.kernel.unset;
        DRM_NOUVEAU_GSP_DEFAULT = lib.mkForce lib.kernel.unset;
        DRM_NOUVEAU_SVM = lib.mkForce lib.kernel.unset;
        DRM_VBOXVIDEO = lib.mkForce lib.kernel.unset;
        DRM_VC4_HDMI_CEC = lib.mkForce lib.kernel.unset;
        FANOTIFY_ACCESS_PERMISSIONS = lib.mkForce lib.kernel.unset;
        FB_3DFX_ACCEL = lib.mkForce lib.kernel.unset;
        FB_ATY_CT = lib.mkForce lib.kernel.unset;
        FB_ATY_GX = lib.mkForce lib.kernel.unset;
        FB_NVIDIA_I2C = lib.mkForce lib.kernel.unset;
        FB_RIVA_I2C = lib.mkForce lib.kernel.unset;
        FB_SAVAGE_ACCEL = lib.mkForce lib.kernel.unset;
        FB_SAVAGE_I2C = lib.mkForce lib.kernel.unset;
        FB_SIS_300 = lib.mkForce lib.kernel.unset;
        FB_SIS_315 = lib.mkForce lib.kernel.unset;
        FSL_MC_UAPI_SUPPORT = lib.mkForce lib.kernel.unset;
        FUSION = lib.mkForce lib.kernel.unset;
        HIPPI = lib.mkForce lib.kernel.unset;
        HOTPLUG_PCI_ACPI = lib.mkForce lib.kernel.unset;
        HOTPLUG_PCI_PCIE = lib.mkForce lib.kernel.unset;
        HSA_AMD = lib.mkForce lib.kernel.unset;
        IO_STRICT_DEVMEM = lib.mkForce lib.kernel.unset;
        IPV6_FOU_TUNNEL = lib.mkForce lib.kernel.unset;
        IPW2100_MONITOR = lib.mkForce lib.kernel.unset;
        IPW2200_MONITOR = lib.mkForce lib.kernel.unset;
        KEXEC_JUMP = lib.mkForce lib.kernel.unset;
        KVM_GENERIC_DIRTYLOG_READ_PROTECT = lib.mkForce lib.kernel.unset;
        KVM_MMIO = lib.mkForce lib.kernel.unset;
        KVM_VFIO = lib.mkForce lib.kernel.unset;
        MEDIA_PCI_SUPPORT = lib.mkForce lib.kernel.unset;
        MEGARAID_NEWGEN = lib.mkForce lib.kernel.unset;
        MLX5_CORE_EN = lib.mkForce lib.kernel.unset;
        MT798X_WMAC = lib.mkForce lib.kernel.unset;
        NET_ACT_BPF = lib.mkForce lib.kernel.unset;
        NET_FC = lib.mkForce lib.kernel.unset;
        NET_VENDOR_MEDIATEK = lib.mkForce lib.kernel.unset;
        NFSD_V4_SECURITY_LABEL = lib.mkForce lib.kernel.unset;
        NFS_V4_SECURITY_LABEL = lib.mkForce lib.kernel.unset;
        PARAVIRT_SPINLOCKS = lib.mkForce lib.kernel.unset;
        PCI_P2PDMA = lib.mkForce lib.kernel.unset;
        PCI_XEN = lib.mkForce lib.kernel.unset;
        PERF_EVENTS_AMD_BRS = lib.mkForce lib.kernel.unset;
        PINCTRL_AMD = lib.mkForce lib.kernel.unset;
        RTW88_8822BE = lib.mkForce lib.kernel.unset;
        RTW88_8822CE = lib.mkForce lib.kernel.unset;
        SATA_MOBILE_LPM_POLICY = lib.mkForce lib.kernel.unset;
        SCSI_SAS_ATA = lib.mkForce lib.kernel.unset;
        SECURITY_APPARMOR = lib.mkForce lib.kernel.unset;
        SECURITY_LANDLOCK = lib.mkForce lib.kernel.unset;
        SECURITY_LOCKDOWN_LSM = lib.mkForce lib.kernel.unset;
        SECURITY_YAMA = lib.mkForce lib.kernel.unset;
        STRICT_DEVMEM = lib.mkForce lib.kernel.unset;
        SUN8I_DE2_CCU = lib.mkForce lib.kernel.unset;
        VBOXGUEST = lib.mkForce lib.kernel.unset;
        VIRTIO_MMIO_CMDLINE_DEVICES = lib.mkForce lib.kernel.unset;
        XEN_HAVE_PVMMU = lib.mkForce lib.kernel.unset;
        XEN_MCE_LOG = lib.mkForce lib.kernel.unset;
        XEN_PVH = lib.mkForce lib.kernel.unset;
        XEN_PVHVM = lib.mkForce lib.kernel.unset;
        XEN_SAVE_RESTORE = lib.mkForce lib.kernel.unset;
      };
    }
  ];
}
